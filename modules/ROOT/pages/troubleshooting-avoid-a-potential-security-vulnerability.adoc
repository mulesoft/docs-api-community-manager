= Avoid a Potential Security Vulnerability
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:imagesdir: ../assets/images/


The guest and member user profile contains the Exchange Viewer permission that gives access to all assets in Exchange with this visibility. An impersonated user can potentially exploit this visibility and access assets that are not intended for them. 

To troubleshoot this issue, ensure that guest and member users can only access intended and required assets.

. Create new teams in Access Management called Guest Community Users and Member Community Users and create a new mapping for External Idp Groups called Community Guest and Community Member.
. In Salesforce, change the Named Credential authentication information.
. In Exchange, share the assets with the Guest Community Users and the Member Community Users team.
. In Access Management, remove the Exchange Viewer permission and the inherited permissions of the guest and member user.

To avoid a potential security vulnerability:

. Create new teams in Access Management called Guest Community Users and Member Community Users, then create new mappings for External Idp Groups called Community Guest and Community Member:
.. Go to Access Management.
.. In the Access Management navigation menu, click *Teams*.
.. Click *Create Team* and enter `Guest Community Users`.
.. Select *External Idp Groups* and enter the following fields:
+
* In *Group Name*, enter `Community Guest`.
* In *Provider Name*, select a provider.
.. Click *Save Changes*.
.. For member users, repeat steps a through f to add a team and mapping for Members. Use `Member Community Users` for the team name and `Community Member` for *Group name* of the External Idp Groups .
. In Salesforce, change the Named Credential authentication information:
.. Go to Salesforce > *Setup*.
.. In the *Quick Find* search box, enter `Named Credentials` and select it.
.. Click *Anypoint*.
.. In the *Authentication* section, go to the *Per User Subject* field.
.. In the *Formula Editor* field change `& "|[\"Community User\"]"` to `& IF($User.Alias = "guest", "[\"Community Guest\"]", "[\"Community User\"]")`.
.. Click *Save*.
.. For member users, repeat steps a through e and change the *Formula Editor* field to `& "|[\"Community User\"]"` to `& IF($User.Alias = "member", "[\"Community Member\"]", "[\"Community User\"]")`.
.. Click *Save*.
. In Exchange, share the asset with the Guest Community Users or the Member Community Users team. Repeat these steps for each asset you want to share with guest community users:
.. Go to Exchange and select the asset.
.. Click *Share*. 
.. In the *Collaborators* tab, enter `Guest Community Users` or `Member Community Users`.
.. Click *Save*.
. In Access Management, remove the ability for users to see the inherited permissions from the Exchange Viewer permission:
.. Go to Access Management > *Users*.
.. Select the guest user.
.. In *Permissions*, move the slider to disable showing inherited permissions.
.. For the member usesr, repeat steps a through c.
